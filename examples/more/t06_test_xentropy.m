cc all
%%
t =  [ 1
      0
     0
     1
     ];
Y_n = [0.1 0.9
     0.9 .1
     .8 .2
     .35  .65
    ];



% eps = 1e-15

w32 = log(Y_n(:,1)).*~t + log(Y_n(:,2)).*t;

-sum(w32)/4

tx =  [ 0 1
      1 0
     1 0
     0 1
     ];
xentropy(tx, Y_n)/4

%%
Y_n = [0 1
     1 0
     1 0
     0 1
    ];
epsi = 1e-1;
w32 = log(clip(Y_n(:,1), epsi, 1-epsi )).*~t + log(clip(Y_n(:,2), ...
    epsi , 1-epsi )).*t;
-sum(w32)/4



xentropy(tx, Y_n, 1, 1e-1)/4

%%
tx = [0 1 0 
    0 0 1
    1 0 0
    0 0 1];
Y_n = [0, 0.1, 0.9
0.8, 0.2, 0
0.2, 0.8, 0
0.0, 0.7, .30];
xentropy(tx, Y_n, 1, 1e-1)/4

%%
tx = [1 0 0 
    0 0 1
    0 1 0
    0 0 1];
Y_n = [0, 0.1, 0.9
0.8, 0.2, 0
0.2, 0.8, 0
0.0, 0.7, .30];
xentropy(tx, Y_n, 1, 1e-1)/4


%%
tx = [0 1 0 
    0 0 1
    1 0 0
    0 0 1];
Y_n = [0.1, 0.1, 0.8
0.8, 0.1, 0.1
0.2, 0.7, 0.1
0.1, 0.6, .30];
xentropy(tx, Y_n, 1, 1e-2)/4



%%
tx = [0 1 0 
    0 0 1
    1 0 0
    0 0 1];
Y_n = [0.1, 0.1, 0.8
0.8, 0.1, 0.1
0.2, 0.7, 0.1
0.1, 0.6, .30];
xentropy(tx, Y_n, 1, 1e-2)*3/4
